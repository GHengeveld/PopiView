<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <title>Index</title>
        <link rel="stylesheet" href="component?file=css/style.css" type="text/css" />
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    </head>
    <body>
        <div id="colleft">
            <div id="deviators">
		        <table></table>
            </div>
            <div id="keywordcloud">
                <ul></ul>
            </div>
        </div>
        <div id="colright">
        	<div id="hitmonitor">
	        	<ul></ul>
	        </div>
        </div>
    	<script type="text/javascript">
    	var deviators = setInterval('updateDeviators()', 60000);
    	var keywordcloud = setInterval('updateKeywordCloud()', 60000);
    	var monitor = setInterval('updateMonitor()', 3000);
    	function updateDeviators(){
    		$.getJSON('deviators.json', function(data){
    			var items = ''
    			for (x in data){
    				if (data[x].value > 0) { data[x].value = '+' + data[x].value; }
	    			items += '<tr><td>' + data[x].url + '</td><td>' + data[x].value + ' %</td></tr>';
		    	}
		    	$('#deviators table').html(items);
    		});
	}
	function updateKeywordCloud(){
    		$.getJSON('keywordcloud.json', function(data){
    			var items = ''
    			for (x in data){
                    items += '<li style="font-size:' + data[x][1] + '%;">' + data[x][0] + '</li>';
    			}
    			$('#keywordcloud ul').html(items);
    		});
    	}
    	function updateMonitor(){
    		$.getJSON('hitmonitor.json', function(data){
    			var item
    			for (x in data) {
    				item = '<li>' + data[x].path + '</li>';
    				if ($('#hitmonitor ul li').length >= 20) {
    					$('#hitmonitor ul li:last').remove();
    				}
    				$('#hitmonitor ul').prepend(item);
    			}
    		});
    	}
	$(document).ready(function(){
		updateDeviators();
		updateKeywordCloud();
		updateMonitor();
	});
    	</script>
    </body>
</html>
<!--
<script type="text/javascript">
  document.write('<img src="http://popiview.infrae.com/image.gif?ref='+escape(document.referrer)+'" alt="" width="1" height="1" />');
</script><noscript><img src="http://popiview.infrae.com/image.gif" width="1" height="1" /></noscript>
-->
